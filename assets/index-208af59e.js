var m=Object.defineProperty;var P=(a,s,t)=>s in a?m(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t;var n=(a,s,t)=>(P(a,typeof s!="symbol"?s+"":s,t),t);import{f as d,d as x,u as b,o as f,c as g,a as l,e as c,F as w,r as k,t as C,p as R,b as D}from"./index-03a3b8e0.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";class I{constructor(s){n(this,"currentPage");n(this,"totalPage");n(this,"pageSize");n(this,"params");n(this,"datas");n(this,"requestFn");n(this,"responseCompletion");n(this,"refreshing");n(this,"loading");n(this,"finished");this.requestFn=s.requestFn,this.params=s.params||{},this.datas=s.datas,this.responseCompletion=s.responseCompletion,this.pageSize=s.pageSize??20,this.currentPage=d(1),this.totalPage=d(1),this.refreshing=d(!1),this.loading=d(!1),this.finished=d(!1)}loadData(){const s={currentPage:this.currentPage.value,pageSize:this.pageSize,...this.params};this.currentPage.value===1&&(this.datas.value=[]),this.requestFn(s).then(t=>{if(!t)return;this.totalPage.value=t.totalPage;let o=t.responseObject.items;this.responseCompletion&&(o=this.responseCompletion(this,t.datas)),this.currentPage.value===1?this.datas.value=o:this.datas.value=this.datas.value.concat(o),this.didLoaded()})}didLoaded(){this.currentPage.value===1?(this.refreshing.value=!1,this.finished.value=!1):this.loading.value=!1}headerRefreshing(){this.currentPage.value=1,this.loadData()}footerRefreshing(){if(this.currentPage.value===this.totalPage.value){this.finished.value=!0,this.didLoaded();return}this.currentPage.value+=1,this.loadData()}}const q=a=>(R("data-v-9940155b"),a=a(),D(),a),S={class:"page_container"},y={class:"nav_bar"},L=q(()=>l("span",{class:"nav_title"},"PagingIndex",-1)),M={class:"flex_1 ofa w_100"},j={class:"float_wrap flex_column"},B=x({__name:"index",setup(a){const s=b();class t{constructor(e){this.name=e,this.name=e}}const o=Array.from({length:50},(i,e)=>new t(`name：${e+1}`)),_=function(i,e){if(Math.ceil(o.length/e)<i)throw new Error("当前页过长");const r=(i-1)*e,u=i*e<o.length?i*e:o.length;return{responseObject:{items:o.slice(r,u)},totalPage:Math.ceil(o.length/e),currentPage:i,pageSize:e}},v=i=>new Promise(e=>{const r=_(i.currentPage,i.pageSize);e(r)}),p=d([]),h=new I({requestFn:v,datas:p,pageSize:5});return h.headerRefreshing(),(i,e)=>(f(),g("div",S,[l("div",y,[l("span",{class:"back_btn",onClick:e[0]||(e[0]=r=>c(s).back())}," < "),L]),l("div",M,[(f(!0),g(w,null,k(p.value,(r,u)=>(f(),g("div",{key:u,class:"list_item"},C(r.name),1))),128))]),l("div",j,[l("div",{onClick:e[1]||(e[1]=(...r)=>c(h).headerRefreshing&&c(h).headerRefreshing(...r))},"下拉刷新"),l("div",{onClick:e[2]||(e[2]=(...r)=>c(h).footerRefreshing&&c(h).footerRefreshing(...r))},"上拉加载")])]))}});const E=F(B,[["__scopeId","data-v-9940155b"]]);export{E as default};
